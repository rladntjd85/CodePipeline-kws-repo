<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
	<meta charset="UTF-8">
	<title>인사 발령</title>
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" th:href="@{/personnel/css/personnel_trans_save.css}">
</head>
<body>

	<div class="container-fluid">
		<div class="card shadow mb-4">
			<div class="card-header py-3">
				<h5 class="m-0 font-weight-bold">인사발령</h5>
			</div>
			<div class="card-body">
				<div id="modalEmployeeSearchArea" class="card shadow mb-4">
					<div class="card-header py-3">
						<h6 class="m-0 font-weight-bold">사원 검색</h6>
					</div>
					<div class="card-body">
						<div class="d-flex mb-3 gap-2">
							<select id="modalDeptSelect" class="form-select" aria-label="부서">
								<option value="">부서 선택</option>
								<option th:each="departments : ${departments}"
										th:value="${departments.comDtId}"
										th:text="${departments.comDtNm}">
								</option>
							</select>
							<select id="modalPositionSelect" class="form-select" aria-label="직급">
								<option value="">직급 선택</option>
								<option th:each="position : ${position}"
										th:value="${position.comDtId}"
										th:text="${position.comDtNm}">
								</option>
							</select> <input type="text" id="modalEmployeeSearchInput"
								class="form-control flex-grow-1" placeholder="이름 또는 사원번호">
							<button id="modalSearchEmployeeBtn" class="btn btn-primary">검색</button>
						</div>
						<div class="table-responsive">
							<table class="table table-hover">
								<thead>
									<tr>
										<th>사원번호</th>
										<th>이름</th>
										<th>부서</th>
										<th>직급</th>
										<th>전화번호</th>
									</tr>
								</thead>
								<tbody id="modalEmployeeTableBody">
									<tr>
										<td colspan="5" class="text-center">사원 검색 결과가 없습니다.</td>
									</tr>
								</tbody>
							</table>
						</div>
					</div>
				</div>

				<div class="modal-content-area">
					<div class="employee-info-section">
						<h6>선택된 사원 정보</h6>
						<div class="mb-2">
							<strong>이름:</strong> <span id="selectedEmployeeName"></span>
						</div>
						<div class="mb-2">
							<strong>사원번호:</strong> <span id="selectedEmployeeId"></span>
						</div>
						<div class="mb-2">
							<strong>현재 부서:</strong> <span id="selectedEmployeeCurrentDept"></span>
						</div>
						<div class="mb-2">
							<strong>현재 직급:</strong> <span id="selectedEmployeeCurrentPosition"></span>
						</div>
						<input type="hidden" id="hiddenSelectedEmployeeDbId">
					</div>

					<div class="new-order-form-section">
						<h6>발령 정보 입력</h6>
						<div class="d-flex mb-3 gap-3">
							<div class="flex-fill">
								<div class="form-group mb-3">
									<label for="transTypeSelect" class="form-label">발령 구분:</label>
									<select id="transTypeSelect" class="form-select">
										<option value="">발령구분 선택</option>
										<option value="승진">승진</option>
										<option value="전보">전보</option>
									</select>
								</div>
								<div class="form-group mb-0">
									<label for="transDeptSelect" class="form-label">발령 부서:</label>
									<select id="transDeptSelect" class="form-select">
										<option value="">부서 선택</option>
										<option th:each="departments : ${departments}"
												th:value="${departments.comDtId}"
												th:text="${departments.comDtNm}">
										</option>
									</select>
								</div>
							</div>
							<div class="flex-fill">
								<div class="form-group mb-3">
									<label for="transDateInput" class="form-label">발령 일자:</label> 
									<input type="date" id="transDateInput" class="form-control" th:value="${#dates.format(#dates.createNow(), 'yyyy-MM-dd')}">
								</div>
								<div class="form-group mb-0">
									<label for="transPosSelect" class="form-label">발령 직급:</label>
									<select id="transPosSelect" class="form-select">
										<option value="">직급 선택</option>
										<option th:each="position : ${position}"
												th:value="${position.comDtId}" 
												th:text="${position.comDtNm}">
										</option>
									</select>
								</div>
							</div>
						</div>
						<div class="form-group mb-3">
							<label for="transReasonTextarea" class="form-label">발령 사유:</label>
							<textarea id="transReasonTextarea" class="form-control" rows="3"></textarea>
						</div>
						<div class="form-group mb-3">
    						<label for="approverSelect" class="form-label">결재자:</label> 
    						<select id="approverSelect" class="form-select">
        						<option value="">결재자 선택</option>
    						</select>
						</div>
					</div>
				</div>
			</div>
			<div class="card-footer d-flex justify-content-end gap-2">
				<button type="button" class="btn btn-secondary" onclick="window.close()">취소</button>
				<button type="button" class="btn btn-primary" id="saveBtn">신청</button>
			</div>
			<input type="hidden" id="csrfToken" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
		</div>
	</div>
<script th:inline="javascript">
    const allEmployeesData = [[${allEmployees}]];
    const approversData = [[${approvers}]];
    const csrfToken = [[${_csrf.token}]];
    const csrfHeaderName = [[${_csrf.headerName}]];
</script>
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
	<script th:src="@{/personnel/js/personnel_trans_save.js}"></script>

</body>
</html>